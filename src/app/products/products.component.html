<div class="product-container">
  <h2>Product List</h2>

  <!-- Error Message Display -->
  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
  </div>

  <!-- Loading Indicator -->
  <div *ngIf="isLoading" class="loading">
    Loading...
  </div>

  <!-- Products List -->
  <ul>
    <li *ngFor="let product of products">
      <!-- Product Image Display -->
      <div class="product-image">
        <img *ngIf="product.image" [src]="'data:image/jpeg;base64,' + product.image" alt="{{product.productName}}">
        <ng-template #noImage>
          <p>No image available</p>
        </ng-template>
      </div>

      <!-- Display or Edit Mode -->
      <div *ngIf="product.isEditing">
        <label>Product Name:</label><br />
        <input [(ngModel)]="product.productName" placeholder="Product Name" /><br /><br />
        
        <label>Category:</label><br />
        <select [(ngModel)]="product.categoryName">
          <option value="" disabled selected>Select a Category</option>
          <option *ngFor="let category of categories" [value]="category.categoryName">
            {{ category.categoryName }}
          </option>
        </select><br /><br />
        
        <label>Price:</label><br />
        <div class="price-input">
          ₱<input [(ngModel)]="product.price" type="number" placeholder="Price" />
        </div><br /><br />
        
        <label>Upload Image:</label><br />
        <input type="file" (change)="onFileSelected($event, product)" /><br /><br />
        
        <div class="button-group">
          <button (click)="updateProduct(product)">Save</button>
          <button (click)="cancelEdit(product)">Cancel</button>
        </div>
      </div>
      <div *ngIf="!product.isEditing">
        <p><strong>Product Name:</strong> {{ product.productName }}</p>
        <p><strong>Category:</strong> {{ product.categoryName }}</p>
        <p><strong>Price:</strong> ₱{{ product.price }}</p>
        <button (click)="enableEdit(product)">Edit</button>
        <button (click)="deleteProduct(product.productID)">Delete</button>
      </div>
    </li>
  </ul>

  <!-- Add New Product -->
  <h2>Add New Product</h2>
  <div class="add-product-form">
    <label>Product Name:</label><br />
    <input [(ngModel)]="newProduct.productName" placeholder="Enter product name" /><br /><br />

    <label>Category:</label><br />
    <select [(ngModel)]="newProduct.categoryName">
      <option value="" disabled selected>Select a Category</option>
      <option *ngFor="let category of categories" [value]="category.categoryName">
        {{ category.categoryName }}
      </option>
    </select><br /><br />

    <label>Price:</label><br />
    <div class="price-input">
      ₱<input [(ngModel)]="newProduct.price" type="number" placeholder="Enter price" />
    </div><br /><br />

    <label>Upload Image:</label><br />
    <input type="file" (change)="onFileSelected($event)" /><br /><br />

    <button (click)="createProduct()">Create Product</button>
  </div>
</div>
